{% extends "base.html" %}

{% block title %}Miembros de la lista{% endblock %}

{% block content %}
<div class="max-w-3xl mx-auto space-y-6">

  <!-- CABECERA -->
  <div class="card p-6">
    <h1 class="text-2xl font-bold mb-2">{{ lista.nombre }}</h1>
    <p class="muted">{{ lista.descripcion }}</p>
  </div>

  <!-- FORMULARIO PARA AÑADIR USUARIOS -->
  <div class="card p-6 space-y-4">
    <h2 class="text-lg font-semibold">Añadir usuario</h2>

    <form method="post" class="space-y-3">
      {% csrf_token %}

      <input type="text" name="username" placeholder="Nombre de usuario..." class="input">

      <button class="btn-primary w-full">Agregar</button>
    </form>
  </div>

  <!-- MIEMBROS -->
  <div class="card p-6">
    <h2 class="text-lg font-semibold mb-4">Miembros</h2>

    {% if miembros %}
      <div class="space-y-4">
        {% for m in miembros %}
          <div class="flex items-center justify-between bg-white/40 dark:bg-gray-900/40 p-3 rounded-xl border border-gray-200/60 dark:border-gray-700/60">
            <div class="flex items-center gap-3">
              <img src="{{ m.usuario.profile.avatar.url }}" class="w-10 h-10 rounded-full" alt="">
              <div>
                <a href="{% url 'profile' m.usuario.username %}" class="font-semibold link">
                  @{{ m.usuario.username }}
                </a>
                <p class="muted text-sm">{{ m.usuario.profile.bio|default:"Sin biografía" }}</p>
              </div>
            </div>

            <!-- Botón eliminar -->
            <form method="post" action="{% url 'list_remove_member' lista.id m.usuario.id %}">
              {% csrf_token %}
              <button class="btn-outline text-red-600">Eliminar</button>
            </form>
          </div>
        {% endfor %}
      </div>

    {% else %}
      <p class="muted text-center">No hay miembros en esta lista.</p>
    {% endif %}
  </div>

</div>
{% endblock %}
